<nav class="navbar navbar-dark bg-dark navbar-expand-lg">
        <img src="http://localhost:1337/images/logo.png" style=" width:60px;height:60px;">
    <a class="navbar-brand" href="#"></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup"
        aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="navbar navbar-dark bg-dark" id="navbarNavAltMarkup">
        <div class="navbar-nav">
            <a class="nav-item nav-link " href="/User/Homepage">Home</a>
            <a class="nav-item nav-link" href="/Request/Requestpage">Request for Money</a>
            <a class="nav-item nav-link active" href="/Request/RequestList">Requests List<span class="sr-only">(current)</span></a>
        </div>
    </div>

    <form class="form-inline my-2 my-lg-0" action="/User/logout" method="GET" style="position: absolute; right: 20px">
        <span class="nav justify-content-end navbar-light" style="color: azure;">
            Hi,
            <%=req.session.username %>! (</span><button class="btn btn-light my-2 my-sm-0" style="float:right" type="submit">Logout</button>)
        <span>
        </span>
    </form>
</nav>
<br>
<br>
<div class="container">
    <div class="row">
        <% request.forEach( function(model) { %>
        <div class="col-sm-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">
                        <%= model.name %>
                        <br><br>
                        Borrower's id:
                        <%= model.borrowerId %>
                    </h5>
                    <br>
                    <label><strong> Description/Reason for borrowing money:</strong>
                        <%= model.descr %></label>
                    <br><br>
                    <label><strong> Amount:</strong>
                        <%= model.borrowingAmount %></label>
                    <br><br>
                    <label> <strong>Due Date: </strong>
                        <%= model.dueDate %></label>
                    <br>
                    <br>
                    <label> <strong>Credit Rating: </strong>
                        <%= req.session.user.trustRate %></label>
                    <br>
                    <br>
                    <form action="/Request/RequestList/<%=model.id%>" method='GET'>
                        <button class="btn btn-success" type=button onClick="lend('<%=model.id%>')">Lend Money</button></form>
                </div>
            </div>
        </div>
        <% }); %>
    </div>
</div>

<script>
    async function lend(id) {

        var r = confirm("Do you want to lend money?");
        if (r == true) {
            var response = await fetch("/Request/RequestList/" + id, {
                // var response = await fetch("/Request/RequestList/", {
                method: "POST",
                credentials: 'same-origin',
            });

            if (response.redirected) {
                window.location = response.url;
            }
            else
                if (response.status == 200) {
                    var data = await response.json();
                    alert(data);
                    location.reload(true);
                }
                else if (response.status == 401) {
                    var data = await response.text();
                    alert(data);
                }
                else {
                    alert(response.statusText);
                }
        };
    }
</script>